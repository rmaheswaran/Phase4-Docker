#FROM recapscsb/scsb-base:latest
FROM adoptopenjdk/openjdk8
MAINTAINER HTC ReCAP Support "recap-support@htcindia.com"

ARG TAG
ENV envTag="$TAG"

# Create config directory
RUN mkdir /opt/cas-config
RUN apt-get update && apt-get install -y git

# Copy config files
COPY thekeystore /opt/cas-config/thekeystore
COPY run-cas.sh /opt/cas-config/run-cas.sh
COPY application.yml /opt/cas-config/application.yml

COPY shellBuild.sh /opt/
RUN chmod 750 /opt/shellBuild.sh
RUN cd /opt && ls -l && ./shellBuild.sh ${envTag}

EXPOSE 8080 10443

CMD ["sh","/opt/cas-config/run-cas.sh"]
